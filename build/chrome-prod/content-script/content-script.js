var IS_DEV_BUILD=false;
(()=>{var x=Object.defineProperty;var y=(n,e)=>{for(var t in e)x(n,t,{get:e[t],enumerable:!0})};var g="screenshot",h=chrome?.i18n?.getMessage("@@extension_id"),he=g+"/"+h,p="G-19Y7T52NBH",f="Cu0vRk7eTX21s66ymUrdIQ";var pe="https://chrome.google.com/webstore/detail/"+h;async function w(){let{sessionData:n}=await chrome.storage.session.get("sessionData"),e=Date.now();return n&&n.timestamp&&((e-n.timestamp)/6e4>30?n=null:(n.timestamp=e,await chrome.storage.session.set({sessionData:n}))),n||(n={session_id:e.toString(),timestamp:e.toString()},await chrome.storage.session.set({sessionData:n})),n.session_id}var I="https://www.google-analytics.com/mp/collect",E="https://www.google-analytics.com/debug/mp/collect",v=p,L=f,N=100,_=class{debug=IS_DEV_BUILD;constructor(){}async getOrCreateClientId(){let{clientId:e}=await chrome.storage.local.get("clientId");return e||(e=self.crypto.randomUUID(),await chrome.storage.local.set({clientId:e})),e}async getSessionId(){try{return w()}catch{return new Promise(t=>{chrome.runtime.sendMessage("get_or_create_session_id",o=>{t(o)})})}}async fireEvent(e,t={}){t.session_id||(t.session_id=await this.getSessionId()),t.engagement_time_msec||(t.engagement_time_msec=N);try{let o=await fetch(`${this.debug?E:I}?measurement_id=${v}&api_secret=${L}`,{method:"POST",body:JSON.stringify({client_id:await this.getOrCreateClientId(),events:[{name:e,params:t}]})});if(!this.debug)return;console.log(await o.text())}catch(o){console.error("Google Analytics request failed with an exception",o)}}async firePageViewEvent(e,t,o={}){return this.fireEvent("page_view",{page_title:e,page_location:t,...o})}async fireErrorEvent(e,t={}){return this.fireEvent("exception",{description:e.message,...e,...t})}},xe=new _;var k=g,a=class{tag="";analytics=new _;constructor(e){this.tag=k+"."+(typeof e=="string"?e:e.constructor.name),this.listenForBgLogs()}listenForBgLogs(){chrome?.runtime?.onMessage.addListener((e,t)=>{t.id!==chrome.runtime.id||e.action!="log"||this.internalLogTagOverride(e.data.level,e.data.tag,...e.data.messages)})}debug=(...e)=>this.internalLog(3,...e);log=(...e)=>this.internalLog(2,...e);warn=(...e)=>this.internalLog(1,...e);error=(...e)=>this.internalLog(0,...e);internalLog(e,...t){this.internalLogTagOverride(e,this.tag,...t)}internalLogTagOverride(e,t,...o){let l=new Date(Date.now()),i=["%c%s %s","color: blue",`[${l.getHours()}:${l.getMinutes()}:${l.getSeconds()}]`,t,...o];if(IS_DEV_BUILD)switch(e){case 3:console.debug(...i);break;case 1:console.warn(...i);break;case 2:console.log(...i);break;case 0:console.error(...i);break}else{switch(e){case 1:this.analytics.fireErrorEvent(new Error(i.join(" ")));break;case 0:this.analytics.fireErrorEvent(new Error(i.join(" ")));break}return}}};var c={};y(c,{"@testMarkup":()=>A,All_done_:()=>Z,Cloned_the_repository_at____________a_href__https___github_com_justiceo_xtension__https___github_com_justiceo_xtension__a____________and_installed_all_the_dependencies_:()=>X,Disable_storage_sync:()=>R,Disabled_on_Websites:()=>G,Enabled_dev_mode_on_Chrome_Firefox_and_installed_an_unpacked___________extension___:()=>V,Extension_will_not_run_on_these_sites__Enter_one_site_per_line_:()=>U,Glad_you_like_it__Can_you_help_us_share_the____:()=>_e,Hooray____:()=>H,How_are_we_doing_:()=>ae,How_can_we_improve_:()=>F,I_say_that_is_great_progress_towards_creating_a_browser_extension_:()=>q,If_you_are_looking_at_this_page__you_successfully:()=>j,If_you_found_this_extension_helpful__leave_a_star_on_the_Github_Page_________or_rating_on_Chrome_Webstore_:()=>te,Next__Pin_it:()=>K,No:()=>le,Options:()=>oe,Rate_on_Chrome_Web_Store:()=>ne,Report_an_Issue:()=>ie,Share_the_love_:()=>ee,Show_Demo:()=>re,Star_on_GitHub:()=>se,Submit_Feedback:()=>ge,Successfully_updated_settings:()=>B,Temporarily_disable_extension:()=>M,Thanks_for_the_feedback_:()=>ce,Turns_off_the_extension_on_all_websites_:()=>C,Used_ESBuild_to_build_the_source_code_and_packaged_into_store_ready___________format_:()=>$,Welcome:()=>W,Your_settings_will_not_propagate_to_other_browsers_:()=>P,_strong_1___strong__Click_on_the_extensions_icon_:()=>J,_strong_2___strong__Find__Browser_Extension_Starter__in_the_list_of_______extensions_:()=>z,_strong_3___strong__Click_on_the_pin_icon_on_the_right_of_this_______extension_s_icon_:()=>Q,const_appDesc:()=>O,const_appName:()=>T,const_appShortName:()=>D,default:()=>ue,or_you_were_able_to_start_an_instance_of_Puppeteer_with_the___________extension_installed_:()=>Y});var T={message:"Visual Snippets: Screenshot, Annotate & Share",description:"The name of the extension"},D={message:"Screenshot",description:"The short-version name of the extension name"},O={message:"Capture, annotate screenshots of webpages and share with one click",description:"The description of your extension"},A={message:"<div><p>Hello world</p>This is the <strong>language</strong> of the web</div>"},M={message:"Temporarily disable extension"},C={message:"Turns off the extension on all websites."},R={message:"Disable storage sync"},P={message:"Your settings will not propagate to other browsers."},G={message:"Disabled on Websites"},U={message:"Extension will not run on these sites. Enter one site per line."},B={message:"Successfully updated settings"},F={message:"How can we improve?"},W={message:"Welcome"},H={message:"Hooray! \u{1F389}"},j={message:"If you are looking at this page, you successfully"},X={message:`Cloned the repository at
<a href="https://github.com/justiceo/xtension">https://github.com/justiceo/xtension</a>
and installed all the dependencies.`},$={message:`Used ESBuild to build the source code and packaged into store-ready
format.`},V={message:`Enabled dev mode on Chrome/Firefox and installed an unpacked
extension...`},Y={message:`or you were able to start an instance of Puppeteer with the
extension installed.`},q={message:"I say that is great progress towards creating a browser extension."},K={message:"Next: Pin it"},J={message:"<strong>1.</strong> Click on the extensions icon."},z={message:`<strong>2.</strong> Find "Browser Extension Starter" in the list of
extensions.`},Q={message:`<strong>3.</strong> Click on the pin icon on the right of this
extension's icon.`},Z={message:"All done."},ee={message:"Share the love!"},te={message:`If you found this extension helpful, leave a star on the Github Page
or rating on Chrome Webstore.`},se={message:"Star on GitHub"},ne={message:"Rate on Chrome Web Store"},oe={message:"Options"},re={message:"Show Demo"},ie={message:"Report an Issue"},ae={message:"How are we doing?"},_e={message:"Glad you like it! Can you help us share the \u2764\uFE0F?"},ce={message:"Thanks for the feedback!"},le={message:"No"},ge={message:"Submit Feedback"},ue={const_appName:T,const_appShortName:D,const_appDesc:O,"@testMarkup":A,Temporarily_disable_extension:M,Turns_off_the_extension_on_all_websites_:C,Disable_storage_sync:R,Your_settings_will_not_propagate_to_other_browsers_:P,Disabled_on_Websites:G,Extension_will_not_run_on_these_sites__Enter_one_site_per_line_:U,Successfully_updated_settings:B,How_can_we_improve_:F,Welcome:W,Hooray____:H,If_you_are_looking_at_this_page__you_successfully:j,Cloned_the_repository_at____________a_href__https___github_com_justiceo_xtension__https___github_com_justiceo_xtension__a____________and_installed_all_the_dependencies_:X,Used_ESBuild_to_build_the_source_code_and_packaged_into_store_ready___________format_:$,Enabled_dev_mode_on_Chrome_Firefox_and_installed_an_unpacked___________extension___:V,or_you_were_able_to_start_an_instance_of_Puppeteer_with_the___________extension_installed_:Y,I_say_that_is_great_progress_towards_creating_a_browser_extension_:q,Next__Pin_it:K,_strong_1___strong__Click_on_the_extensions_icon_:J,_strong_2___strong__Find__Browser_Extension_Starter__in_the_list_of_______extensions_:z,_strong_3___strong__Click_on_the_pin_icon_on_the_right_of_this_______extension_s_icon_:Q,All_done_:Z,Share_the_love_:ee,If_you_found_this_extension_helpful__leave_a_star_on_the_Github_Page_________or_rating_on_Chrome_Webstore_:te,Star_on_GitHub:se,Rate_on_Chrome_Web_Store:ne,Options:oe,Show_Demo:re,Report_an_Issue:ie,How_are_we_doing_:ae,Glad_you_like_it__Can_you_help_us_share_the____:_e,Thanks_for_the_feedback_:ce,No:le,Submit_Feedback:ge};var u=new a("i18n");function me(n){let e=/^[a-zA-Z0-9_]+$/;return n.split("").map(t=>e.test(t)?t:"_").join("")}var r=n=>{if(!n)return u.error("A valid key is required for i18n, got",n),n;let e=n.startsWith("@")?n:me(n);if(chrome?.i18n&&chrome.i18n.getMessage(e)!=="")return chrome.i18n.getMessage(e);u.warn("chrome.i18n is not available in the current context, falling back to en-US"),Object.keys(c).forEach(t=>{});for(let[t,o]of Object.entries(c))if(t===e)return o.message;return u.error("No translation available for key:",n),n};var b=[{id:"disable-extension-on-site",type:"checkbox",title:r("Temporarily disable extension"),description:r("Turns off the extension on all websites."),default_value:!1},{id:"disable-sync",type:"checkbox",title:r("Disable storage sync"),description:r("Your settings will not propagate to other browsers."),default_value:!1,dev_only:!1},{id:"blocked-sites",type:"textarea",title:r("Disabled on Websites"),description:r("Extension will not run on these sites. Enter one site per line."),default_value:""}];var m=class{storageService;constructor(){this.storageService=chrome?.storage?.local??window.localStorage}put(e,t){if(t==null)return Promise.reject("Attempting to save a null value");if(!e)return Promise.reject("Attempting to use a null key");if(!chrome?.storage?.sync)return this.storageService.setItem(e,JSON.stringify(t));let o={};return o[e]=t,this.storageService.set(o)}async get(e){return chrome?.storage?.sync?(await this.storageService.get(e))[e]:JSON.parse(this.storageService.getItem(e))}async remove(e){return e?chrome?.storage?.sync?this.storageService.remove(e):this.storageService.removeItem(e):Promise.reject("Attempting to use a null key")}async getConfig(e){return await this.get(e)??b.find(t=>t.id===e)?.default_value}getAll(){return this.storageService.get(null)}async getAndUpdate(e,t){let o=await this.get(e);return this.put(e,await t(o))}async isCurrentSiteBlocked(){let e=await this.get("blocked-sites");return!!(e&&window.location.hostname&&e.includes(window.location.hostname))}},S=new m;var d=class{logger=new a(this);init(){this.listenForBgMessage()}showDemo(){this.logger.debug("#showDemo")}listenForBgMessage(){chrome?.runtime?.onMessage?.addListener((e,t,o)=>{this.logger.debug("#onMessage: ",e),o("ok")})}};S.isCurrentSiteBlocked().then(n=>{let e=window.self===window.top;!n&&e&&new d().init()});})();
